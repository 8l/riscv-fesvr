#! /usr/bin/python

import sys
from fesvr_htif import *
from fesvr_tmif import *

if len(sys.argv) < 2:
  print "usage: %s elfs" % sys.argv[0]
  sys.exit(0)

htif = htif_isasim_t()
tmif = tmif_t(htif)

for i in range(1, len(sys.argv)):
  tmif.load_elf(sys.argv[i])

tmif.start()

while True:
  mm = tmif.run_until_tohost()
  tmif.syscall(mm)
  tmif.write_fromhost(1)
